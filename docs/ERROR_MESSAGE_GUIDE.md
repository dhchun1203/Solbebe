# 에러 메시지 처리 가이드

이 문서는 Solbebe 프로젝트에서 인증 관련 에러 메시지가 어떻게 처리되는지 설명합니다.

---

## 로그인 에러 메시지

### 1. 존재하지 않는 이메일 또는 잘못된 비밀번호

**상황**: 사용자가 등록되지 않은 이메일로 로그인하거나, 잘못된 비밀번호를 입력한 경우

**표시되는 메시지**: 
```
이메일 또는 비밀번호가 올바르지 않습니다.
```

**참고**: 
- Supabase는 보안상 이메일이 존재하지 않는지, 비밀번호가 틀린지 구분하지 않습니다.
- 두 경우 모두 "Invalid login credentials" 에러를 반환합니다.
- 이는 악의적인 사용자가 등록된 이메일을 추측하는 것을 방지하기 위한 보안 조치입니다.

### 2. 이메일 미인증

**상황**: 회원가입 후 이메일 인증을 완료하지 않은 경우

**표시되는 메시지**:
```
이메일 인증이 완료되지 않았습니다. 이메일을 확인해주세요.
```

### 3. 너무 많은 로그인 시도

**상황**: 짧은 시간 내에 여러 번 로그인을 시도한 경우

**표시되는 메시지**:
```
너무 많은 로그인 시도가 있었습니다. 잠시 후 다시 시도해주세요.
```

### 4. 네트워크 오류

**상황**: 인터넷 연결이 끊어지거나 서버에 연결할 수 없는 경우

**표시되는 메시지**:
```
네트워크 오류가 발생했습니다. 인터넷 연결을 확인해주세요.
```

---

## 회원가입 에러 메시지

### 1. 이미 등록된 이메일

**상황**: 이미 가입된 이메일로 회원가입을 시도한 경우

**표시되는 메시지**:
```
이미 등록된 이메일입니다. 로그인해주세요.
```

### 2. 비밀번호 형식 오류

**상황**: 비밀번호가 너무 짧거나 형식이 올바르지 않은 경우

**표시되는 메시지**:
```
비밀번호가 너무 짧거나 형식이 올바르지 않습니다.
```

### 3. 이메일 형식 오류

**상황**: 올바르지 않은 이메일 형식을 입력한 경우

**표시되는 메시지**:
```
올바른 이메일 형식이 아닙니다.
```

---

## 비밀번호 찾기 에러 메시지

### 1. 등록되지 않은 이메일

**상황**: 등록되지 않은 이메일로 비밀번호 재설정을 요청한 경우

**표시되는 메시지**:
```
등록되지 않은 이메일입니다. 이메일 주소를 확인해주세요.
```

**참고**: 
- Supabase는 보안상 이메일이 존재하지 않아도 성공을 반환할 수 있습니다.
- 실제로는 등록된 이메일만 재설정 링크가 발송됩니다.
- 에러가 명시적으로 반환되는 경우에만 위 메시지가 표시됩니다.

### 2. 너무 많은 요청

**상황**: 짧은 시간 내에 여러 번 비밀번호 재설정을 요청한 경우

**표시되는 메시지**:
```
너무 많은 요청이 있었습니다. 잠시 후 다시 시도해주세요.
```

---

## 에러 메시지 처리 로직

### authStore.js

`src/store/authStore.js`의 `signIn` 함수에서 Supabase 에러를 사용자 친화적인 메시지로 변환합니다:

```javascript
// Supabase 에러 코드 확인
if (errorMsg.includes('invalid login credentials')) {
  errorMessage = '이메일 또는 비밀번호가 올바르지 않습니다.'
} else if (errorMsg.includes('email not confirmed')) {
  errorMessage = '이메일 인증이 완료되지 않았습니다.'
} // ... 기타 에러 처리
```

### LoginModal.jsx

에러 메시지는 빨간색 배경의 에러 박스에 표시됩니다:

```jsx
{error && (
  <div className="text-red-500 text-sm bg-red-50 p-3 rounded-lg">
    {error}
  </div>
)}
```

---

## 테스트 방법

### 1. 존재하지 않는 이메일로 로그인

1. 로그인 모달 열기
2. 등록되지 않은 이메일 입력 (예: `test@example.com`)
3. 임의의 비밀번호 입력
4. 로그인 버튼 클릭
5. **예상 결과**: "이메일 또는 비밀번호가 올바르지 않습니다." 메시지 표시

### 2. 잘못된 비밀번호로 로그인

1. 로그인 모달 열기
2. 등록된 이메일 입력
3. 잘못된 비밀번호 입력
4. 로그인 버튼 클릭
5. **예상 결과**: "이메일 또는 비밀번호가 올바르지 않습니다." 메시지 표시

### 3. 이미 등록된 이메일로 회원가입

1. 회원가입 모드로 전환
2. 이미 가입된 이메일 입력
3. 비밀번호 입력
4. 회원가입 버튼 클릭
5. **예상 결과**: "이미 등록된 이메일입니다. 로그인해주세요." 메시지 표시

### 4. 등록되지 않은 이메일로 비밀번호 찾기

1. 비밀번호 찾기 페이지로 이동 (`/forgot-password`)
2. 등록되지 않은 이메일 입력
3. 재설정 링크 보내기 버튼 클릭
4. **예상 결과**: 에러가 명시적으로 반환되는 경우 "등록되지 않은 이메일입니다." 메시지 표시

---

## 보안 고려사항

### 1. 이메일 존재 여부 노출 방지

Supabase는 보안상 다음 정보를 노출하지 않습니다:
- 특정 이메일이 등록되어 있는지 여부
- 로그인 실패 원인 (이메일 없음 vs 비밀번호 틀림)

따라서 두 경우 모두 동일한 에러 메시지를 표시합니다:
```
이메일 또는 비밀번호가 올바르지 않습니다.
```

### 2. 비밀번호 재설정

Supabase의 `resetPasswordForEmail`은 보안상 이메일이 존재하지 않아도 성공을 반환할 수 있습니다. 실제로는:
- 등록된 이메일: 재설정 링크 발송
- 등록되지 않은 이메일: 아무 작업도 수행하지 않음 (하지만 성공 응답 반환)

이렇게 하면 악의적인 사용자가 등록된 이메일을 추측하는 것을 방지할 수 있습니다.

---

## 에러 메시지 커스터마이징

에러 메시지를 수정하려면 `src/store/authStore.js` 파일의 `signIn` 및 `signUp` 함수를 수정하세요.

```javascript
// 예시: 더 구체적인 메시지로 변경
if (errorMsg.includes('invalid login credentials')) {
  errorMessage = '입력하신 정보를 확인해주세요. 이메일과 비밀번호가 일치하지 않습니다.'
}
```

---

이 가이드를 참고하여 에러 메시지가 올바르게 표시되는지 확인하세요!









